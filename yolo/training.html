

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Training a YOLOv5 Model &#8212; Rowan Blueberry Project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'yolo/training';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Validating a YOLOv5 Model" href="validating.html" />
    <link rel="prev" title="Preparing Lambda &amp; Familiarizing with Linux" href="lambda-linux.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Rowan Blueberry Project - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Rowan Blueberry Project - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the Rowan Blueberry Docs
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Using Roboflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../roboflow/getting-started.html">Getting Started with Roboflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roboflow/annotating.html">Annotating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roboflow/exporting.html">Exporting an Annotated Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Using CVAT</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cvat/getting-started.html">Getting Started with CVAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cvat/annotating.html">Annotating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cvat/exporting.html">Exporting an Annotated Dataset (to Lambda)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">YOLOv5</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="venv.html">Virtual Environments in Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda-linux.html">Preparing Lambda &amp; Familiarizing with Linux</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Training a YOLOv5 Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="validating.html">Validating a YOLOv5 Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross-validation.html">How to Perform K-Fold Cross-Validation with YOLOv5</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Scripts/Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Custom-Made Scripts for this Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/software.html">Software for the project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc/blueberry.html">What Blueberries Look Like</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/demosite.html">Demo Website</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/docsite.html">How to Work on the Documentation Website (This Site!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/terms.html">Important Terms &amp; Definitions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fyolo/training.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/yolo/training.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Training a YOLOv5 Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-dataset">Preparing Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assigning-images-to-validation-dataset">Assigning Images to Validation Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#augmentations">Augmentations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-train-py-script">Understanding the train.py script</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-parameters">Notable parameters:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-train-py">Using train.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-errors">Potential Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filenotfound">FileNotFound</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#some-python-package-not-installed">Some Python Package Not Installed</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#something-about-cuda-memory">Something About CUDA Memory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-the-results">Seeing the Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Using Train.py</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="training-a-yolov5-model">
<h1>Training a YOLOv5 Model<a class="headerlink" href="#training-a-yolov5-model" title="Permalink to this heading">#</a></h1>
<p>After you successfully export some dataset to Lambda (see <a class="reference internal" href="../cvat/exporting.html"><span class="doc std std-doc">Exporting Data on CVAT</span></a>), you will want to train with that dataset. In order to train, we will have to ensure our data is ready for training.</p>
<section id="preparing-dataset">
<h2>Preparing Dataset<a class="headerlink" href="#preparing-dataset" title="Permalink to this heading">#</a></h2>
<p>Every training session needs training data (obviously), but it also needs validation data to generate metrics during training. You <b>CANNOT</b> train without validation data.</p>
<p>We will also want to make sure we perform any augmentations to our dataset before using it to train.</p>
<section id="assigning-images-to-validation-dataset">
<h3>Assigning Images to Validation Dataset<a class="headerlink" href="#assigning-images-to-validation-dataset" title="Permalink to this heading">#</a></h3>
<p>You may use a platform to export your data split up into train/valid/test folders. If you are using CVAT, you will have to do this yourself. Fortunately, we have a script for it.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">dataset_assigner.py</span></code> script, you can assign a certain percentage of your data in train/valid/test (for more details, see <a class="reference internal" href="../scripts/scripts.html"><span class="doc std std-doc">Our Scripts</span></a>)</p>
<pre>
<b>NOTE:</b> 

If you intend to split this data into tiles, or any other kind of augmentation that will increase the number of images/labels in your dataset, you will want to perform this step <b>LAST</b>. 

<b>Imagine:</b> You have 10 full-sized images, assign 2 to valid, and then split all of the data into tiles, generating 25 tiles each image. Your dataset is much larger now, but the validation dataset is limited to data from those 2 photos you originally assigned, rather than assigning 50 tiles from a tiled dataset of 250 images.
</pre>
</section>
<section id="augmentations">
<h3>Augmentations<a class="headerlink" href="#augmentations" title="Permalink to this heading">#</a></h3>
<p>YOLOv5 performs various augmentations, which you can read about here: <a class="reference external" href="https://github.com/ultralytics/yolov5/discussions/10469">Forum Post about YOLOv5 Augmentation Pipeline</a>.</p>
<p>We may perform augmentations of our own from time to time. One such augmentation may be to simply cut our images up into square tiles of 640x640 or some other dimension. We have a script for this, called the <code class="docutils literal notranslate"><span class="pre">FullBushDivider.py</span></code> (for more details, see <a class="reference internal" href="../scripts/scripts.html"><span class="doc std std-doc">Our Scripts</span></a>).</p>
</section>
</section>
<section id="understanding-the-train-py-script">
<h2>Understanding the <a class="reference external" href="http://train.py">train.py</a> script<a class="headerlink" href="#understanding-the-train-py-script" title="Permalink to this heading">#</a></h2>
<p>The YOLOv5 repo comes equipped with scripts that we can use to train, validate, or test our models.</p>
<p>For now, we’ll focus on <a class="reference external" href="http://train.py">train.py</a>.</p>
<p>I recommend opening up the scripts (and that goes for scripts made by the team as well) and seeing how to use it, and what the code is doing.</p>
<p>To get an idea of how to use <a class="reference external" href="http://train.py">train.py</a>, let’s see what can figure out by opening it in a text editor, anything works but I’ll use nano: <code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">train.py</span></code></p>
<p><img alt="Training 1" src="../_images/training1.png" /></p>
<p>At the top we should see some examples of how we can use this script. (It’s good practice to include these at the top of your scripts as well.)</p>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h3>
<p>According to their Usage comment, the following command would train on a single GPU: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train.py</span> <span class="pre">--data</span> <span class="pre">--coco128.yaml</span> <span class="pre">--weights</span> <span class="pre">yolov5s.pt</span> <span class="pre">--img</span> <span class="pre">640</span></code></p>
<p>This example seems pretty simple, but only if you use a couple of parameters, there are many settings/parameters that we can pass in, so let’s get an idea of what those look like.</p>
<p>Scrolling down in this script, we can find a parse_opt function and get an idea of all the different parameters we can use (and their defaults).</p>
<p><img alt="Training 2" src="../_images/training2.png" /></p>
</section>
<section id="notable-parameters">
<h3>Notable parameters:<a class="headerlink" href="#notable-parameters" title="Permalink to this heading">#</a></h3>
<ul>
<li>weights - The size of model you want to create.
<li>data - The path to the data.yaml of the dataset you are using.
<li>hyp - The hyperparameter file you want to use.
<li>epochs - The number of epochs for training.
<li>batch-size - The batch size for the GPU (higher number quickens training time at the cost of the GPU working harder)
<li>imgsz - The dimension of the images in training (assumes it is square).
<li>device - The GPU to assign this training job to.
<li>name - The name of the training job.
</ul>
<p>If you want to read more about the parameters, there’s a bit more information here: <a class="github reference external" href="https://github.com/ultralytics/yolov5/issues/6507">ultralytics/yolov5#6507</a></p>
</section>
</section>
<section id="using-train-py">
<h2>Using <a class="reference external" href="http://train.py">train.py</a><a class="headerlink" href="#using-train-py" title="Permalink to this heading">#</a></h2>
<p>There are many parameters that we can play around with in training, (and other Hyperparameters but that’s a topic for another section).</p>
<p>For our use case, we really only need to do general training without making many adjustments to how we train. Following their usage example (mentioned previously) we can train by using the <a class="reference external" href="http://train.py">train.py</a> script like so:</p>
<p>(With a virtual environment active) <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train.py</span> <span class="pre">--data</span> <span class="pre">./data/training_data/Some_Dataset/data.yaml</span> <span class="pre">--epochs</span> <span class="pre">300</span> <span class="pre">--batch-size</span> <span class="pre">32</span> <span class="pre">--name</span> <span class="pre">Some_Dataset</span></code></p>
<p>If everything went well, you should see a bunch of details about the training start to be logged to the terminal like so:</p>
<p><video width="500" height="400" 
       src="../_static/videos/Yolo_Training_Example_4x.mp4"  
       controls>
</video></p>
<section id="potential-errors">
<h3>Potential Errors<a class="headerlink" href="#potential-errors" title="Permalink to this heading">#</a></h3>
<p>You might encounter a whole host of different errors when trying to train. This section can’t be all encompassing, but here are some errors that MIGHT happen, and how you can fix them.</p>
<section id="filenotfound">
<h4>FileNotFound<a class="headerlink" href="#filenotfound" title="Permalink to this heading">#</a></h4>
<p>If the path you pass in (after <code class="docutils literal notranslate"><span class="pre">--data</span></code>) is spelled wrong in any way (case sensitive!), OR if any path names in the data.yaml are not accurate to where the datasets are, then you might see this.</p>
</section>
<section id="some-python-package-not-installed">
<h4>Some Python Package Not Installed<a class="headerlink" href="#some-python-package-not-installed" title="Permalink to this heading">#</a></h4>
<p>If it tells you that you are missing some package, you will get yelled at for not having a specific package. This would likely happen if you 1. haven’t activated your python environment, or 2. forgot to install all packages in a requirements.txt file.</p>
</section>
<section id="something-about-cuda-memory">
<h4>Something About CUDA Memory<a class="headerlink" href="#something-about-cuda-memory" title="Permalink to this heading">#</a></h4>
<p>If it tells you that you can’t train because there isn’t enough CUDA memory left, then there are probably many jobs running on the GPUs. You can check the utilization of the GPUs by using the command <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code>.</p>
<p><img alt="NVIDIA-SMI" src="../_images/nvidia-smi.png" /></p>
<p>You should see all 8 GPUs and a bunch of details about how much memory they’re allocating to any running processes. Using this knowledge, If you can’t train because of the GPUs running something else, then use a different GPU!</p>
<p>By adding <code class="docutils literal notranslate"><span class="pre">--device</span> <span class="pre">#</span></code> (where # is the number of the GPU 0-7), you can assign your training job to that specific GPU.</p>
</section>
</section>
</section>
<section id="seeing-the-results">
<h2>Seeing the Results<a class="headerlink" href="#seeing-the-results" title="Permalink to this heading">#</a></h2>
<p>After successfully training, navigate to the finished run by going to this path:
<code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/data/drone/YOUR_NAME/yolov5/runs/train/TRAINING_NAME/</span></code></p>
<p>In this directory, there are results for the training, including plots, a csv file of the metrics each epoch, and some other things. There is a directory called <code class="docutils literal notranslate"><span class="pre">weights</span></code> and in this directory there should be a <code class="docutils literal notranslate"><span class="pre">best.pt</span></code> weight file, which is the file we use to apply our training weights to the YOLO model.</p>
<p>(Some of us tend to refer to this file <i>as</i> the model, but it is simply the weights we <i>use</i> on the model).</p>
<p><img alt="Training3" src="../_images/training3.png" /></p>
<p>Later, when you need to make predictions, you’ll use this <code class="docutils literal notranslate"><span class="pre">best.pt</span></code> weight file and apply it to the YOLOv5 model. See <a class="reference internal" href="predicting.html"><span class="doc std std-doc">Making Predictions with YOLOv5</span></a> for the next steps.</p>
</section>
<section id="id1">
<h2>Using <a class="reference external" href="http://Train.py">Train.py</a><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>We have our own script <code class="docutils literal notranslate"><span class="pre">Train.py</span></code> that makes it a bit easier to use the <code class="docutils literal notranslate"><span class="pre">train.py</span></code> script. See <a class="reference internal" href="../scripts/scripts.html"><span class="doc std std-doc">Our Scripts</span></a> for more information.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>You now know how to:</p>
<ul>
<li>Prepare a dataset for training
<li>Training a YOLOv5 model
</ul>
<hr class="docutils" />
<p>With this information, you can either continue on to <a class="reference internal" href="predicting.html"><span class="doc std std-doc">Making Predictions with YOLOv5</span></a> or <a class="reference internal" href="validating.html"><span class="doc std std-doc">Validating a YOLOv5 Model</span></a> (depending on what you’re doing).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./yolo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lambda-linux.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preparing Lambda &amp; Familiarizing with Linux</p>
      </div>
    </a>
    <a class="right-next"
       href="validating.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Validating a YOLOv5 Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-dataset">Preparing Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assigning-images-to-validation-dataset">Assigning Images to Validation Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#augmentations">Augmentations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-train-py-script">Understanding the train.py script</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-parameters">Notable parameters:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-train-py">Using train.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-errors">Potential Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filenotfound">FileNotFound</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#some-python-package-not-installed">Some Python Package Not Installed</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#something-about-cuda-memory">Something About CUDA Memory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-the-results">Seeing the Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Using Train.py</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brandon McHenry
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>